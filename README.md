# 鸣潮声骸选择

## 技术选型

vue3 + ts + less

环境：node 18

工具：

1. vite
2. yarn

## 功能

鸣潮声骸选择工具（以下简称本工具）可以根据用户选择的共鸣者、共鸣链等级、武器和武器谐振等级，计算出对应属性声骸套装全部9种搭配的伤害期望，
以供养成参考。

> 9种声骸搭配：44111/43311，以及主属性4c暴击/暴伤、3c属性伤害/攻击，之间的排列组合。  
> 技能倍率按照全技能打一套计算，不考虑复杂排轴。  
> 默认共鸣者等级为90级、武器等级为90级、技能等级为10级、固有技能已点亮、声骸等级为25级、声骸副词条只有最低值的暴击暴伤。  
> 默认所有的限时加成效果全程生效，包括但不限于：共鸣链等级效果、固有技能、武器技能、声骸套装效果。

## 实现

> 参考视频：BV1VZ42147px（b站）

根据金铃子攻略组公布的伤害公式（详见参考视频），总伤害由**8**个乘区构成，每个乘区内又包含多个词条。其中各乘区之间乘算、乘区内加算。

伤害公式乘区：

1. 基数区：攻击力，包含白值和黄值。
    1. 白值：共鸣者攻击力+武器攻击力
    2. 黄值：百分比攻击力和固定数值攻击力，其中百分比攻击力是基于**白值**的百分比
2. 倍率乘区：技能倍率，包括技能基础倍率和倍率提升（多见于共鸣链）
3. 伤害加成乘区：延奏
4. 伤害加深区：包含属性伤害加成和技能伤害加成
    1. 属性伤害加成：就是面板上的6种属性伤害加成，取共鸣者属性对应的那一条
    2. 技能伤害加成：分为**普攻、重击、E、R**，也在面板上有所体现
5. 暴击乘区：暴击率和暴击伤害，鸣潮的面板暴击伤害就是暴击后的伤害（而非暴击增伤）
6. 防御乘区：计算公式：**（100+L1)/(199+L1+L2)。L1：玩家等级，L2：怪物等级**
7. 抗性乘区：全属性抗性10%，对应属性抗性特化：大世界40%、深塔60%、全息80%
8. 其他：例如无音区的特殊buff

本工具在计算过程中不考虑敌人防御、不考虑另外两位共鸣者，即本工具仅涉及**1、2、4、5**，4个乘区。

### 计算步骤

计算用户选择的共鸣者、共鸣链等级、武器、武器谐振等级，其结果与声骸模块计算，得出最终结果。

1. 为共鸣者应用共鸣链等级、为武器应用谐振等级
2. 计算应用提升后的共鸣者携带指定武器的各项数值
3. 将各声骸组合分别计算进上一步的结果，排序

攻击力乘区（1区）计算规则：

1. 白值：角色基础攻击力+武器基础攻击力
2. 固定黄值：声骸（4c/3c）固定主属性
3. 百分比黄值：共鸣者技能树、共鸣链等级效果、武器主词条、武器技能效果、声骸主词条
4. 将固定黄值折算成百分比，则最终攻击力=白值*（1+百分比攻击力）

技能倍率乘区（2区）计算规则：（4位小数）

1. 按照全技能打一套，分别统计各技能类型的倍率
2. 根据用户选择的共鸣链等级，应用相关倍率提升/增加

伤害加深乘区（4区）计算规则：

1. 属性伤害加成：共鸣者技能树、共鸣链等级效果、武器技能效果、声骸套装、声骸主词条、声骸主动
2. 技能类型伤害加成：共鸣者技能树、武器技能效果、声骸主动
3. 将各技能类型伤害加成根据对应技能类型的倍率占比，折算为属性伤害加成

暴击乘区（5区）计算规则：

1. 暴击率：共鸣者技能树、武器主词条、武器技能效果、声骸主词条、声骸副词条（使用默认值）
2. 暴击伤害：共鸣者技能树、武器主词条、武器技能效果、声骸主词条、声骸副词条（使用默认值）

## FAQ

Q. 为什么想要做这样一个工具？  
A. 社区经常看到有人问声骸，是带44111还是43311、4c带暴击还是暴伤、3c带攻击还是属性伤害……
但鸣潮里有很多因素都会影响声骸的选择，例如共鸣链等级、武器效果等，
这些因素具体到每个人都不尽相同，要针对每个人的情况计算他适合怎么带声骸，那你就算去吧，一算一个不吱声。  
所以我想做一个工具，隐藏复杂的计算过程，让用户通过简单的几项选择即可得知自己手上的共鸣者适合怎样搭配声骸，以及不同搭配之间的差距。

Q. 为什么展示界面将**总伤害期望**和**暴击率**独立于其他细节展示出来呢？  
A. 暴击率除了影响暴击伤害期望，还涉及到手感问题，而这是一个主观的概念，因人而异。  
有的人能接受50%暴击率硬凹；有的人觉得95%的暴击率还差点意思。  
本工具仅能计算暴击伤害期望，无法反映出手感问题。对此，我会在每一套搭配中注明暴击率，请在参考搭配前自行确认能否接受该暴击率的手感。  
同时，再次声明：**本工具默认所有声骸均包含暴击率副词条且数值最低。(6.3/12.6)**
因为暴击率相对容易获取，所以实际养成后的暴击率会略高于本工具计算出的数值。
